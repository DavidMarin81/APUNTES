# Ejemplo: Guardar y leer el nombre del usuario
## Configuración previa
- Suponemos que ya tenemos en `Program.cs`:
    ~~~csharp
    builder.Services.AddDistributedMemoryCache();
    builder.Services.AddSession(options =>
    {
        options.IdleTimeout = TimeSpan.FromMinutes(30);
        options.Cookie.HttpOnly = true;
        options.Cookie.IsEssential = true;
    });

    var app = builder.Build();
    app.UseSession();
    ~~~

## Guardar datos en la sesión
- Supongamos que quieres guardar el nombre del usuario cuando entra en la página `/login`:
    ~~~csharp
    app.MapGet("/login", (string nombre, HttpContext context) =>
    {
        // Guardar el nombre en la sesión
        context.Session.SetString("NombreUsuario", nombre);

        return $"Hola {nombre}, tu sesión se ha iniciado.";
    });
    ~~~
    - Qué pasa aquí:
        - El usuario entra en `http://localhost:5000/login?nombre=Ana`
        - Se guarda `"Ana"` en la sesión bajo la clave `"NombreUsuario"`
        - La respuesta dice `"Hola Ana, tu sesión se ha iniciado"`

## Leer los datos de la sesión
- Ahora quieres mostrar el nombre en otra ruta `/perfil`:
    ~~~csharp
    app.MapGet("/perfil", (HttpContext context) =>
    {
        // Leer el nombre de la sesión
        string nombre = context.Session.GetString("NombreUsuario");

        if (string.IsNullOrEmpty(nombre))
            return "No hay sesión iniciada.";
        
        return $"Bienvenido de nuevo, {nombre}!";
    });
    ~~~
    - Qué pasa aquí:
        - El usuario entra en `/perfil`
        - ASP.NET Core busca la sesión usando la cookie `ASP.NET_Session_id`
        - Recupera `"Ana"` y muestra `"Bienvenida de nuevo, Ana"`
        - Si la sesión expiró o nunca se inició, muestra `"No hay sesión iniciada"`

## El flujo completo resumido
| Paso | Acción del usuario | Qué hace `Session` |
| --- | --- | --- |
| 1 | Usuario visita `/login?nombre=Ana` | Guarda `"Ana"` en la sesión |
| 2 | Usuario visita `/perfil` | Recupera `"Ana"` de la sesión y lo muestra |
| 3 | Usuario cierra el navegador o expira sesión | Datos se borran automáticamente |


